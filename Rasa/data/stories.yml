version: "3.1"
stories:
  - story: ask a faq
    steps:
      - intent: faq
      - action: action_faq_get_answer
  - story: happy path
    steps:
      - intent: mood_great
      - action: utter_happy
  - story: show more products 1
    steps:
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
      - intent: affirm
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
  - story: show more products 1
    steps:
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
      - intent: deny
      - action: utter_like_to_know_more
  - story: search product by name and show more products 1
    steps:
      - intent: get_top_product_info_by_name
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
      - intent: affirm
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
  - story: search product by name and show more products 2
    steps:
      - action: utter_like_to_know_more
      - intent: get_top_product_info_by_name
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
      - intent: affirm
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
  - story: search product by name and show more products 3
    steps:
      - action: utter_like_to_know_more
      - intent: get_top_product_info_by_name
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
      - intent: affirm
      - action: action_get_top_product_info_by_name
      - action: utter_ask_to_show_more_products
  - story: search product by barcode 1
    steps:
      - intent: scan_barcode
      - action: action_get_product_info_by_barcode
  - story: search product by barcode 2
    steps:
      - intent: scan_barcode
      - action: action_get_product_info_by_barcode
      - action: utter_like_to_know_more
  - story: search product by barcode 3
    steps:
      - action: utter_like_to_know_more
      - intent: scan_barcode
      - action: action_get_product_info_by_barcode
  - story: search product by barcode and ask about property 1
    steps:
      - action: utter_like_to_know_more
      - intent: affirm
      - action: utter_specify_question
      - intent: ask_about_product_property_by_barcode
      - action: action_answer_about_product_property_by_barcode
  - story: search product by barcode and ask about property 2
    steps:
      - intent: ask_about_product_property_by_barcode
      - action: action_answer_about_product_property_by_barcode
      - action: utter_like_to_know_more
  - story: search product by barcode and ask about property 3
    steps:
      - action: utter_like_to_know_more
      - intent: ask_about_product_property_by_barcode
      - action: action_answer_about_product_property_by_barcode
  - story: ask about animal friendliness
    steps:
      - action: utter_like_to_know_more
      - slot_was_set:
          - barcode
      - intent: affirm
      - action: utter_specify_question
      - intent: ask_about_animal_friendliness_of_product
      - action: action_get_product_animal_friendliness_info
      - action: utter_did_that_help
      - intent: deny
      - action: utter_goodbye
  - story: ask about animal friendliness 2
    steps:
      - action: utter_like_to_know_more
      - slot_was_set:
          - barcode
      - intent: ask_about_animal_friendliness_of_product
      - action: action_get_product_animal_friendliness_info
      - action: utter_did_that_help
      - intent: deny
      - action: utter_goodbye
  - story: set ingredient preference
    steps:
      - intent: set_ingredient_preference
      - action: action_confirm_preference
  - story: set nutritional value preference
    steps:
      - intent: set_nutr_value_preference
      - action: action_confirm_preference
  - story: set food processing preference
    steps:
      - intent: set_food_processing_preference
      - action: action_confirm_preference
  - story: set allergen preference
    steps:
      - intent: set_allergen_preference
      - action: action_confirm_preference
  - story: set label preference path 1
    steps:
      - intent: set_label_preference
      - action: action_confirm_preference
  - story: set label preference path 2
    steps:
      - intent: scan_barcode
      - action: action_get_product_info_by_barcode
      - action: utter_did_that_help
      - intent: affirm
      - action: utter_happy
      - intent: set_label_preference
      - action: action_confirm_preference
  - story: set label preference path 3
    steps:
      - intent: set_label_preference
      - action: action_confirm_preference
      - intent: scan_barcode
      - action: action_get_product_info_by_barcode
      - action: utter_did_that_help
      - intent: affirm
      - action: utter_happy
  - story: set environment preference
    steps:
      - intent: set_env_preference
      - action: action_confirm_preference
  - story: ask for preferences
    steps:
      - intent: ask_preferences
      - action: action_print_preferences
  - story: search product by barcode
    steps:
      - intent: scan_barcode
      - action: action_get_product_info_by_barcode
      - action: utter_did_that_help
      - intent: deny
      - action: utter_goodbye
  - story: compare multiple products - ask for first two products' barcode
    steps:
      - or:
          - intent: ask_for_product_comparison
          - intent: compare_products_with_name
      - action: action_set_comparison_path_active_to_true
      - action: action_update_comparison_list_and_length
      - action: product_comparison_form
      - active_loop: product_comparison_form
      - slot_was_set:
          - requested_slot: first_product_for_comparison
      - intent: scan_barcode
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - action: product_comparison_form
      - slot_was_set:
          - requested_slot: second_product_for_comparison
      - intent: scan_barcode
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - action: action_fill_second_product_for_comparison
      - slot_was_set:
          - second_product_for_comparison
      - action: product_comparison_form
      - slot_was_set:
          - requested_slot: null
      - active_loop: null
      - action: utter_more_products_or_compare
  - story: compare multiple products - add more products
    steps:
      - action: utter_more_products_or_compare
      - or:
          - intent: scan_barcode
          - intent: add_more_barcodes_to_comparison_list
          - intent: provide_multiple_barcodes
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - action: utter_more_products_or_compare
  - story: compare multiple products - start comparison
    steps:
      - action: utter_more_products_or_compare
      - intent: start_product_comparison
      - action: action_compare_products_by_barcode
      - action: utter_stop_compare_or_know_more_about_the_result
  - story: "compare multiple products - after run compare, stop comparison"
    steps:
      - action: utter_stop_compare_or_know_more_about_the_result
      - intent: stop_comparing_and_clear_comparison_history
      - action: action_stop_comparing_and_clear_compare_history
      - action: action_deactivate_loop
      - active_loop: null
      - action: utter_greet
  - story: >-
      compare multiple products - after run compare, know more about the
      comparison result
    steps:
      - action: utter_stop_compare_or_know_more_about_the_result
      - intent: know_more_about_comparison_result
      - action: utter_specify_question
  - story: compare multiple products - all barcodes provided at beginning
    steps:
      - intent: compare_products_with_barcode_given
      - action: action_set_comparison_path_active_to_true
      - action: action_update_comparison_list_and_length
      - action: utter_more_products_or_compare
      - or:
          - intent: scan_barcode
          - intent: add_more_barcodes_to_comparison_list
          - intent: provide_multiple_barcodes
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - action: utter_more_products_or_compare
  - story: "compare multiple products - ask for barcode, multiple are given at once"
    steps:
      - or:
          - intent: ask_for_product_comparison
          - intent: compare_products_with_name
      - action: action_set_comparison_path_active_to_true
      - action: action_update_comparison_list_and_length
      - action: product_comparison_form
      - active_loop: product_comparison_form
      - slot_was_set:
          - requested_slot: first_product_for_comparison
      - intent: provide_multiple_barcodes
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - action: action_deactivate_loop
      - active_loop: null
      - action: utter_more_products_or_compare
  - story: interactive_story_compare_1
    steps:
      - intent: ask_for_product_comparison
      - action: action_set_comparison_path_active_to_true
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list: []
      - slot_was_set:
          - product_comparison_list_length: 0
      - action: product_comparison_form
      - active_loop: product_comparison_form
      - slot_was_set:
          - product_comparison_list: []
      - slot_was_set:
          - product_comparison_list_length: 0
      - slot_was_set:
          - requested_slot: first_product_for_comparison
      - intent: provide_multiple_barcodes
        entities:
          - barcode: "3168930009078"
          - barcode: "7613035974685"
          - barcode: "3017620422003"
      - slot_was_set:
          - comparison_path_active: true
      - slot_was_set:
          - barcode: "3017620422003"
      - slot_was_set:
          - barcode_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - first_product_for_comparison: "3017620422003"
      - slot_was_set:
          - product_comparison_list: []
      - slot_was_set:
          - product_comparison_list_length: 0
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_deactivate_loop
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: utter_more_products_or_compare
      - intent: start_product_comparison
      - slot_was_set:
          - second_product_for_comparison: "3168930009078"
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_compare_products_by_barcode
      - action: utter_stop_compare_or_know_more_about_the_result
      - intent: stop_comparing_and_clear_comparison_history
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_stop_comparing_and_clear_compare_history
      - slot_was_set:
          - product_comparison_list: null
      - slot_was_set:
          - product_comparison_list_length: 0
      - slot_was_set:
          - first_product_for_comparison: null
      - slot_was_set:
          - second_product_for_comparison: null
      - slot_was_set:
          - product_comparison_result: null
      - slot_was_set:
          - comparison_path_active: false
      - slot_was_set:
          - barcode_list: null
      - action: action_deactivate_loop
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: utter_greet
  - story: interactive_story_compare_2
    steps:
      - intent: ask_for_product_comparison
      - action: action_set_comparison_path_active_to_true
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list: []
      - slot_was_set:
          - product_comparison_list_length: 0
      - action: product_comparison_form
      - active_loop: product_comparison_form
      - slot_was_set:
          - product_comparison_list: []
      - slot_was_set:
          - product_comparison_list_length: 0
      - slot_was_set:
          - requested_slot: first_product_for_comparison
      - intent: scan_barcode
        entities:
          - barcode: "3168930009078"
      - slot_was_set:
          - comparison_path_active: true
      - slot_was_set:
          - barcode: "3168930009078"
      - slot_was_set:
          - barcode_list:
              - "3168930009078"
      - slot_was_set:
          - first_product_for_comparison: "3168930009078"
      - slot_was_set:
          - product_comparison_list: []
      - slot_was_set:
          - product_comparison_list_length: 0
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
      - slot_was_set:
          - product_comparison_list_length: 1
      - action: product_comparison_form
      - slot_was_set:
          - requested_slot: second_product_for_comparison
      - intent: scan_barcode
        entities:
          - barcode: "7613035974685"
      - slot_was_set:
          - comparison_path_active: true
      - slot_was_set:
          - barcode: "7613035974685"
      - slot_was_set:
          - barcode_list:
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
      - slot_was_set:
          - product_comparison_list_length: 1
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 2
      - action: action_fill_second_product_for_comparison
      - slot_was_set:
          - second_product_for_comparison: "7613035974685"
      - action: product_comparison_form
      - slot_was_set:
          - requested_slot: null
      - active_loop: null
      - action: utter_more_products_or_compare
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 2
      - intent: scan_barcode
        entities:
          - barcode: "3017620422003"
      - slot_was_set:
          - comparison_path_active: true
      - slot_was_set:
          - barcode: "3017620422003"
      - slot_was_set:
          - barcode_list:
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 2
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: utter_more_products_or_compare
      - intent: start_product_comparison
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_compare_products_by_barcode
      - action: utter_stop_compare_or_know_more_about_the_result
      - intent: stop_comparing_and_clear_comparison_history
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "7613035974685"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_stop_comparing_and_clear_compare_history
      - slot_was_set:
          - product_comparison_list: null
      - slot_was_set:
          - product_comparison_list_length: 0
      - slot_was_set:
          - first_product_for_comparison: null
      - slot_was_set:
          - second_product_for_comparison: null
      - slot_was_set:
          - product_comparison_result: null
      - slot_was_set:
          - comparison_path_active: false
      - slot_was_set:
          - barcode_list: null
      - action: action_deactivate_loop
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: utter_greet
  - story: interactive_story_compare_3
    steps:
      - intent: compare_products_with_barcode_given
        entities:
          - barcode: "3168930009078"
          - barcode: "3017620422003"
      - slot_was_set:
          - barcode: "3017620422003"
      - slot_was_set:
          - barcode_list:
              - "3168930009078"
              - "3017620422003"
      - action: action_set_comparison_path_active_to_true
      - slot_was_set:
          - comparison_path_active: true
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 2
      - action: utter_more_products_or_compare
      - intent: scan_barcode
        entities:
          - barcode: "7613035974685"
      - slot_was_set:
          - comparison_path_active: true
      - slot_was_set:
          - barcode: "7613035974685"
      - slot_was_set:
          - barcode_list:
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "3017620422003"
      - slot_was_set:
          - product_comparison_list_length: 2
      - action: action_update_comparison_list_and_length
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "3017620422003"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: utter_more_products_or_compare
      - intent: show_product_comparison_list
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "3017620422003"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_show_product_comparison_list
      - action: utter_more_products_or_compare
      - intent: start_product_comparison
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "3017620422003"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_compare_products_by_barcode
      - action: utter_stop_compare_or_know_more_about_the_result
      - intent: stop_comparing_and_clear_comparison_history
      - slot_was_set:
          - product_comparison_list:
              - "3168930009078"
              - "3017620422003"
              - "7613035974685"
      - slot_was_set:
          - product_comparison_list_length: 3
      - action: action_stop_comparing_and_clear_compare_history
      - slot_was_set:
          - product_comparison_list: null
      - slot_was_set:
          - product_comparison_list_length: 0
      - slot_was_set:
          - first_product_for_comparison: null
      - slot_was_set:
          - second_product_for_comparison: null
      - slot_was_set:
          - product_comparison_result: null
      - slot_was_set:
          - comparison_path_active: false
      - slot_was_set:
          - barcode_list: null
      - action: action_deactivate_loop
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: utter_greet
